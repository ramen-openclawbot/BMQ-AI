{% extends 'base.html' %}

{% block title %}Purchase Order Details - BMQ AI SKU{% endblock %}

{% block content %}
    <div class="row mb-4">
        <div class="col-md-8">
            <h1 class="h2 mb-0">
                <i class="bi bi-receipt"></i> Purchase Order PO-2026-001
            </h1>
            <small class="text-muted">Premium Flour Mill</small>
        </div>
        <div class="col-md-4 text-end">
            <a href="{% url 'inventory:po_edit' 1 %}" class="btn btn-primary me-2">
                <i class="bi bi-pencil"></i> Edit
            </a>
            <a href="{% url 'inventory:purchaseorder_list' %}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Back
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <!-- PO Details -->
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">Order Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p>
                                <strong>PO Number:</strong> PO-2026-001<br>
                                <strong>Status:</strong> <span class="badge bg-warning">Pending</span><br>
                                <strong>Order Date:</strong> 2026-02-05<br>
                                <strong>Expected Delivery:</strong> 2026-02-10
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p>
                                <strong>Supplier:</strong> Premium Flour Mill<br>
                                <strong>Contact:</strong> Nguyen Van A<br>
                                <strong>Phone:</strong> +84-28-1234-5678<br>
                                <strong>Email:</strong> contact@premiumflour.vn
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Line Items -->
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">Line Items</h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>Ingredient</th>
                                <th>Quantity</th>
                                <th>Unit</th>
                                <th>Unit Price</th>
                                <th>Total</th>
                                <th>Received</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>All-Purpose Flour</strong></td>
                                <td>100</td>
                                <td>kg</td>
                                <td>35,000 ₫</td>
                                <td><strong>3,500,000 ₫</strong></td>
                                <td>0 kg</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-success" data-bs-toggle="modal" data-bs-target="#receiveModal">
                                        <i class="bi bi-check-circle"></i> Receive
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Whole Wheat Flour</strong></td>
                                <td>50</td>
                                <td>kg</td>
                                <td>40,000 ₫</td>
                                <td><strong>2,000,000 ₫</strong></td>
                                <td>0 kg</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-success" data-bs-toggle="modal" data-bs-target="#receiveModal">
                                        <i class="bi bi-check-circle"></i> Receive
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Baking Powder</strong></td>
                                <td>25</td>
                                <td>kg</td>
                                <td>15,000 ₫</td>
                                <td><strong>375,000 ₫</strong></td>
                                <td>0 kg</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-success" data-bs-toggle="modal" data-bs-target="#receiveModal">
                                        <i class="bi bi-check-circle"></i> Receive
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Notes -->
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">Notes</h5>
                </div>
                <div class="card-body">
                    <p>Confirm delivery date. Include invoice number on shipment.</p>
                </div>
            </div>
        </div>

        <!-- Summary -->
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">Order Summary</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Subtotal:</span>
                            <strong>5,875,000 ₫</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Tax (10%):</span>
                            <strong>587,500 ₫</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Shipping:</span>
                            <strong>37,500 ₫</strong>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <strong>Total:</strong>
                            <strong class="text-primary" style="font-size: 1.2rem;">6,500,000 ₫</strong>
                        </div>
                    </div>

                    <div class="mb-3">
                        <h6>Items Received</h6>
                        <p class="mb-0">0 / 3 items received</p>
                        <div class="progress mt-2">
                            <div class="progress-bar" style="width: 0%"></div>
                        </div>
                    </div>

                    <button class="btn btn-primary w-100" disabled>
                        <i class="bi bi-check-circle"></i> Confirm Receipt
                    </button>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">Status Timeline</h5>
                </div>
                <div class="card-body">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-marker text-success">
                                <i class="bi bi-check-circle"></i>
                            </div>
                            <p>
                                <strong>Draft Created</strong><br>
                                <small class="text-muted">2026-01-30 10:00 AM</small>
                            </p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker text-success">
                                <i class="bi bi-check-circle"></i>
                            </div>
                            <p>
                                <strong>PO Submitted</strong><br>
                                <small class="text-muted">2026-02-05 02:30 PM</small>
                            </p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker text-warning">
                                <i class="bi bi-clock"></i>
                            </div>
                            <p>
                                <strong>Pending Delivery</strong><br>
                                <small class="text-muted">Expected: 2026-02-10</small>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Receive Modal -->
    <div class="modal fade" id="receiveModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Receive Item</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label class="form-label">Ingredient</label>
                            <input type="text" class="form-control" value="All-Purpose Flour" disabled>
                        </div>

                        <div class="mb-3">
                            <label for="quantityReceived" class="form-label">Quantity Received</label>
                            <input type="number" step="0.01" class="form-control" id="quantityReceived" placeholder="Enter quantity">
                        </div>

                        <div class="mb-3">
                            <label for="receiveDate" class="form-label">Receive Date</label>
                            <input type="date" class="form-control" id="receiveDate">
                        </div>

                        <div class="mb-3">
                            <label for="notes" class="form-label">Notes</label>
                            <textarea class="form-control" id="notes" rows="3" placeholder="Any quality issues, damages, etc."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary">Receive Item</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
        }

        .timeline-marker {
            position: absolute;
            left: -35px;
            top: 0;
            font-size: 1.2rem;
        }

        .timeline-item p {
            margin-bottom: 0;
        }
    </style>
{% endblock %}
